import unittest
import YKR.utilities
import os

unittest.TestCase.maxDiff = None

# тестовые данный
name_dir_files = []
for (dirpath, dirnames, filenames) in os.walk(r'C:/Users/asus/Documents/NDT YKR/Тестовые данные/'):
    name_dir_files.extend(filenames)
# ожидаемые данные
true_name_dir_files = ['C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-210-HF-104-UTT-22-01 rev.01.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-210-VA-101-UTT-22-01.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-210-VC-101-UTT-22-01.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-210-VE-301-PAUT-22-01.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-331-VN-104-UTT-22-01.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-460-VA-004-UTT-22-01.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-550-VA-151-PAUT-22-02 (Head).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-B4-200-VN-201-UTT-22-01.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-B4-365-ZL-112-UTT-22-01.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-PAUT-20-014(Location 3).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-PAUT-20-078 ( K.O. DRUM ).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-PAUT-21-061 M5 (location 35B).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-PAUT-21-187 (Riser, PR 4.1, CL-16).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-PAUT-22-013 (Riser, B4-2300-BD-604 Loc 03,04).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-PAUT-22-033 (Module 1).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-UT-20-005.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-UT-20-059 Module 20 Line 200.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-UT-20-131.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-UT-21-111 (Island A).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-UTT-21-355 (B4-480-TA-201).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-UTT-22-017 (Module-20, Loc-4,6,7).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OF-UTT-22-065 (RIS).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-20-015.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-20-016.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-20-030.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-20-076.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-20-113 A1-4000-CM-071.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-20-160 Oil Tr3_rev.1.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-21-007 (Gas2 TR2).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-21-308.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-21-309.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-21-336 (Sulfur Tr2).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-21-366 (GAS 2 Tr2 unit 300).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-22-007.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-22-106 WELD (Gas1 Tr1).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-22-141.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-22-171.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-22-740_Corrosion_mapping.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-19-011.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-19-081.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-19-360 A1-690-FG-051A.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-19-388 (A1-600-VA-006).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-20-020 S.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-20-024.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-20-039.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-20-143.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-20-196.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-20-397.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-20-403.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-20-432.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UT-21-019 UT MAT SULPHUR TR2 20 INCH.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-21-317.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-21-419 (C3-160-VA-003).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-21-605 (Unit 520).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-21-761 (KUT 560) 9.12ap.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-21-770.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-21-823(Unit 210 Tr3).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22 -473 (Unit 332 Tr1).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-009 (unit 210 tr 1).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-064 (Unit 332 Tr1).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-112(A1-210-HX-201G).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-265(FGC).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-305 (CON64).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-336-CON35.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-341(KUT 560).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-377-A06.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-618.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-674  Gas 2 Tr1  330.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-714.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-756.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-UTT-22-811.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OS-UT-20-003.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OS-UT-20-394 (M2-400-VA-111).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OS-UT-21-156.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OS-UT-21-794 (M2-400-VA-310).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OS-UTT-21-499 (M2-530-TA-002).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OS-UTT-21-742 (M2-334-TZ-004 (K3  K4).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OS-UTT-22-496 (M2-400-VA-310).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-OS-UTT-22-506 (A1-300-VQ-001).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-PAUT-PRETAR-22-004.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-PAUT-PRETAR-22-014.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-PAUT-PRETAR-OFF-22-002 (B4-200-VS-202).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-PAUT-PRETAR-OFF-22-005 (B4-200-VS-102).docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-UTT-PRETAR-22-024 (A1-460-ZQ-002)UTL.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-UTT-PRETAR-22-164 (A1-320-VA-102)GAS.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-UTT-PRETAR-OFF-22-010.docx',
                       'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-UTT-PRETAR-OFF-22-070 (B4-365-ZL-101B, Module-01).docx'
                       ]


# проверка преобразования к надлежащему виду пути и названий репортов для дальнейшей работы и типа данных на выходе
class TestNameDir(unittest.TestCase):
    def test_name_dir_values(self):
        self.assertEqual(YKR.utilities.get_name_dir(name_dir_files), true_name_dir_files)

    def test_name_dir_types(self):
        self.assertEqual(type(YKR.utilities.get_name_dir(name_dir_files)), list)


# тестовые данные
name_files = ['C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-KR-A1-210-HF-104-UTT-22-01 rev.01.docx',
              'C:/Users/asus/Documents/NDT YKR/Тестовые данные/0-YKR-A1-210-VC-101-UTT-22-01.docx',
              'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-331-HA-104-UTT-22-01.docx',
              'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04YKR-ON-PAUT-20-015.docx',
              'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-20-030.docx'
              ]
# ожидаемые данные
true_name_files = ['C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-A1-331-HA-104-UTT-22-01.docx',
                   'C:/Users/asus/Documents/NDT YKR/Тестовые данные/04-YKR-ON-PAUT-20-030.docx'
                   ]


# проверка выбора только репортов в названиях которых есть "04-YKR"
class TestChangeOnlyYkrReports(unittest.TestCase):
    def test_change_only_ykr_reports(self):
        self.assertEqual(YKR.utilities.change_only_ykr_reports(name_files), true_name_files)


# ожидаемые данные
true_number_report_wo_date = (
    {'report_number': '04-YKR-A1-210-HF-104-UTT-22 01 rev.01', 'report_date': '01.06.2022', 'work_order': '28104008'},
    {'report_number': '04-YKR-A1-210-VA-101-UTT-22-01', 'report_date': '29.05.2022', 'work_order': '28120941'},
    {'report_number': '04-YKR-A1-210-VC-101-UTT-22-01', 'report_date': '06.06.2022', 'work_order': '28103927'},
    {'report_number': '04-YKR-A1-210-VE-301-PAUT-22-01', 'report_date': '19.06.2022', 'work_order': '28104  056'},
    {'report_number': '04-YKR-A1-331-VN-104-UTT-22-01', 'report_date': '10.09.2022', 'work_order': '28103979'},
    {'report_number': '04-YKR-A1-460-VA-004-UTT-22-01', 'report_date': '16.06.2022', 'work_order': '28104015'},
    {'report_number': '04-YKR-A1-550-VA-151-PAUT-22-02', 'report_date': '24.06.2022 ', 'work_order': '28103903 '},
    {'report_number': '04-YKR-B4-200-VN-201-UTT-22-01 ', 'report_date': '06 June 2022', 'work_order': '28098584'},
    {'report_number': '04-YKR-B4-365-ZL-112-UTT-22-01', 'report_date': '05-06 June 2022', 'work_order': '28098869'},
    {'report_number': '04-YKR-OF-PAUT-20-014', 'report_date': '25-Jan-2020', 'work_order': '28131360'},
    {'report_number': '04-YKR-OF-PAUT-20-078', 'report_date': '13-Apr-2020', 'work_order': '28151286'},
    {'report_number': '04-YKR-OF-PAUT-21-061', 'report_date': '03 May 2021', 'work_order': '28225713'},
    {'report_number': '04-YKR-OF-PAUT-21-187', 'report_date': '26.08.2021', 'work_order': '28171289 (CLPW-16)'},
    {'report_number': '04-YKR-OF-PAUT-22-013', 'report_date': '17.02.2022', 'work_order': '28283123'},
    {'report_number': '04-YKR-OF-PAUT-22-033', 'report_date': '16-19 July 2022', 'work_order': '28314660'},
    {'report_number': '04-YKR-OF-UT-20-005', 'report_date': '28 Jan 2020', 'work_order': '28134968'},
    {'report_number': '04-YKR-OF-UT-20-059', 'report_date': '08 May 2020', 'work_order': '28098100'},
    {'report_number': '04-YKR-OF-UT-20-131', 'report_date': '12 Sep 2020', 'work_order': '28145681'},
    {'report_number': '04-YKR-OF-UT-21-111', 'report_date': '26.06.2021', 'work_order': '28235740, 28209632 (CLPW-09)'},
    {'report_number': '04-YKR-OF-UTT-21-355', 'report_date': '13.11.2021', 'work_order': '28216184'},
    {'report_number': '04-YKR-OF-UTT-22-017', 'report_date': '12 February 2022', 'work_order': '28283125'},
    {'report_number': '04-YKR-OF-UTT-22-065', 'report_date': '28.06.2022', 'work_order': '28301677'},
    {'report_number': '04-YKR-ON-PAUT-20-015', 'report_date': '14 Jan 2020', 'work_order': '28061606'},
    {'report_number': '04-YKR-ON-PAUT-20-016', 'report_date': '15,17.01.2020', 'work_order': '28118836'},
    {'report_number': '04-YKR-ON-PAUT-20-030', 'report_date': '11 Feb 2020', 'work_order': '2813\n4184'},
    {'report_number': '04-YKR-ON-PAUT-20-076', 'report_date': '21 May 2020', 'work_order': '28080207'},
    {'report_number': '04-YKR-ON-PAUT-20-113', 'report_date': '03 August 2020', 'work_order': '2 8 1 7 73 20'},
    {'report_number': '04-YKR-ON-PAUT-20-160 Rev.1', 'report_date': '04-08 Dec 2020', 'work_order': '28189494'},
    {'report_number': '04--YKR-ON-PAUT-21-007', 'report_date': '13 January 2021', 'work_order': '28163914'},
    {'report_number': '04-YKR-ON-PAUT-21-308', 'report_date': '05th NOVEMBER 2021', 'work_order': '27988541'},
    {'report_number': '04-YKR-ON-PAUT-21-309', 'report_date': '05th NOVEMBER 2021', 'work_order': '27988541'},
    {'report_number': '04-YKR-ON-PAUT-21-336', 'report_date': '13.12.2021', 'work_order': '28271803'},
    {'report_number': '04-YKR-ON-PAUT-21-366', 'report_date': '28 Dec 21,01-04 Jan 2022', 'work_order': '28277198'},
    {'report_number': '04-YKR-ON-PAUT-22-007', 'report_date': '05 Jan 2022', 'work_order': '28276526'},
    {'report_number': '04-YKR-ON-PAUT-22-106', 'report_date': '10-13 march 2022', 'work_order': '28291331'},
    {'report_number': '04-YKR-ON-PAUT-22-141', 'report_date': '22.03.2022', 'work_order': '28262516'},
    {'report_number': '04-YKR-ON-PAUT-22-171', 'report_date': '01.04.2022', 'work_order': '28289509'},
    {'report_number': '04-YKR-ON-PAUT-22-740', 'report_date': '18 September 2022', 'work_order': '28321639'},
    {'report_number': '04-YKR-ON-UT-19-011', 'report_date': '15 Jan 2019', 'work_order': '28036714'},
    {'report_number': '04-YKR-ON-UT-19-081', 'report_date': '14 Feb 2019', 'work_order': '28061338'},
    {'report_number': '04-YKR-ON-UT-19-360', 'report_date': '01 July 2019', 'work_order': '28047503'},
    {'report_number': '04-YKR-ON-UT-19-388', 'report_date': '14 July 2019', 'work_order': '28046962'},
    {'report_number': '04-YKR-ON-UT-20-020', 'report_date': '21 Jan 2020', 'work_order': '28133727'},
    {'report_number': '04-YKR-ON-UT-20-024', 'report_date': '23 Jan 2020', 'work_order': '28139870'},
    {'report_number': '04-YKR-ON-UT-20-039', 'report_date': '26 Jan 2020', 'work_order': '28139870'},
    {'report_number': '04-YKR-ON-UT-20-143', 'report_date': '10 Mar 2020', 'work_order': '28147638'},
    {'report_number': '04-YKR-ON-UT-20-196', 'report_date': '26 Apr 2020', 'work_order': '280544 44'},
    {'report_number': '04-YKR-ON-UT-20-397', 'report_date': '16 Nov 2020', 'work_order': '28198807'},
    {'report_number': '04-YKR-ON-UT-20-403', 'report_date': '20 Nov 2020', 'work_order': '28189493'},
    {'report_number': '04-YKR-ON-UT-20-432', 'report_date': '24 Dec 2020', 'work_order': '28146761'},
    {'report_number': '04-YKR-ON-UT-21-019', 'report_date': '07 January 2021', 'work_order': '28179078'},
    {'report_number': '04-YKR-ON-UT-21-317', 'report_date': '12.06.2021', 'work_order': '28193441'},
    {'report_number': '04-YKR-ON-UTT-21-419', 'report_date': '02.08.2021', 'work_order': '28144303'},
    {'report_number': '04-YKR-ON-UT-21-605', 'report_date': '15.10.2021', 'work_order': '28260303'},
    {'report_number': '04-YKR-ON-UT-21-761', 'report_date': '09.12.2021', 'work_order': '28270173'},
    {'report_number': '04-YKR-ON-UT-21-770', 'report_date': '02.12.2021', 'work_order': '28268723'},
    {'report_number': '04-YKR-ON-UTT-21-823', 'report_date': '17.12.2021', 'work_order': '28276529'},
    {'report_number': '04-YKR-ON-UTT-22-473', 'report_date': '20.05.2022', 'work_order': '28283756'},
    {'report_number': '04-YKR-ON-UT-22-009', 'report_date': '08.01..2022', 'work_order': '28261530'},
    {'report_number': '04-YKR-ON-UT-22-064', 'report_date': '30.01.2022', 'work_order': '2825645          7'},
    {'report_number': '04-YKR-ON-UTT-22-112', 'report_date': '01.03.2022', 'work_order': '28282656'},
    {'report_number': '04-YKR-ON-UTT 22-265', 'report_date': '13.04.2022', 'work_order': '28283755'},
    {'report_number': '04-YKR-ON-UTT\n-22-305', 'report_date': '20.04.2022', 'work_order': '28301822'},
    {'report_number': '04-YKR        -ON-UTT-22-336', 'report_date': '23.04.2022', 'work_order': '28301819'},
    {'report_number': '04-YKR-ON- \nUTT-22-341', 'report_date': '25.04.2022', 'work_order': '28291314'},
    {'report_number': '04-YKR-ON-UTT-22-377', 'report_date': '26.04.2022', 'work_order': '28301824'},
    {'report_number': '04-YKR-ON-UTT-22-618', 'report_date': '05.10.2022', 'work_order': '28283748'},
    {'report_number': '04-YKR-ON-UTT-22-674', 'report_date': '03.11.2022', 'work_order': '28304185'},
    {'report_number': '04-YKR-ON-UTT-22-714', 'report_date': '17.11.2022', 'work_order': '28289520'},
    {'report_number': '04-YKR-ON-UTT-22-756\n', 'report_date': '06.12.2022', 'work_order': '28283755'},
    {'report_number': '04-YKR-ON-UTT-22-811', 'report_date': '28.12.2022', 'work_order': '28343836'},
    {'report_number': '04-YKR-OS-UT-20-003', 'report_date': '02 Jan 2020', 'work_order': '28127480'},
    {'report_number': '04-YKR-OS-UT-20-394', 'report_date': '11 Nov 2020', 'work_order': '28187548'},
    {'report_number': '04-YKR-OS-UT-21-156', 'report_date': '18 Mar 2021', 'work_order': '28210044'},
    {'report_number': '04-YKR-OS-UT-21-794', 'report_date': '20.12.2021', 'work_order': '28271835'},
    {'report_number': '04-YKR-OS-UTT-21-499', 'report_date': '29.08.2021', 'work_order': '28223596'},
    {'report_number': '04-YKR-OS-UTT-21-742', 'report_date': '19.11.2021', 'work_order': '28271019'},
    {'report_number': '04-YKR-OS-UTT-22-496', 'report_date': '24.07.2022', 'work_order': '28296054'},
    {'report_number': '04-YKR-ON-UTT-22-506', 'report_date': '03.08.2022', 'work_order': 'NCOC Request'},
    {'report_number': '04-YKR-PAUT-PRETAR-SRU-22-004', 'report_date': '06.04.2022', 'work_order': '28103893'},
    {'report_number': '04-YKR-PAUT-PRETAR-Gas-22-014', 'report_date': '02.05.2022', 'work_order': '28103903'},
    {'report_number': '04-YKR-PAUT-PRETAR-OFF-22-002', 'report_date': '02.04.2022', 'work_order': '28098582'},
    {'report_number': '04-YKR-PAUT-PRETAR-OFF-22-005', 'report_date': '17.04.2022', 'work_order': '28098335'},
    {'report_number': '04-YKR-ON-PRETAR-UTT-\n22-024', 'report_date': '20.03.2022', 'work_order': '28146514'},
    {'report_number': '04-YKR-UTT-PRETAR-GAS-22-164', 'report_date': '01-03.05.2022', 'work_order': '28103943'},
    {'report_number': '04-YKR-UTT-PRETAR-OFF-22-010', 'report_date': '14.03.2022', 'work_order': '28098534'},
    {'report_number': '04-YKR-UTT-PRETAR-OFF-22 070', 'report_date': '01 May 2022', 'work_order': '28098546'})


# проверка получение фактического номера репорта, номера work order и даты
class TestGetNumberReportWoDate(unittest.TestCase):
    def test_get_number_report_wo_date(self):
        for i, path_report in enumerate(true_name_dir_files):
            self.assertEqual(type(YKR.utilities.number_report_wo_date(path_report)), dict)
            self.assertEqual(YKR.utilities.number_report_wo_date(path_report), true_number_report_wo_date[i])


true_clear_number_report_wo_date = (
    {'report_number': '04-YKR-A1-210-HF-104-UTT-2201_rev.01', 'report_date': '01.06.2022', 'work_order': '28104008'},
    {'report_number': '04-YKR-A1-210-VA-101-UTT-22-01', 'report_date': '29.05.2022', 'work_order': '28120941'},
    {'report_number': '04-YKR-A1-210-VC-101-UTT-22-01', 'report_date': '06.06.2022', 'work_order': '28103927'},
    {'report_number': '04-YKR-A1-210-VE-301-PAUT-22-01', 'report_date': '19.06.2022', 'work_order': '28104056'},
    {'report_number': '04-YKR-A1-331-VN-104-UTT-22-01', 'report_date': '10.09.2022', 'work_order': '28103979'},
    {'report_number': '04-YKR-A1-460-VA-004-UTT-22-01', 'report_date': '16.06.2022', 'work_order': '28104015'},
    {'report_number': '04-YKR-A1-550-VA-151-PAUT-22-02', 'report_date': '24.06.2022.', 'work_order': '28103903'},
    {'report_number': '04-YKR-B4-200-VN-201-UTT-22-01', 'report_date': '06.June.2022', 'work_order': '28098584'},
    {'report_number': '04-YKR-B4-365-ZL-112-UTT-22-01', 'report_date': '05-06.June.2022', 'work_order': '28098869'},
    {'report_number': '04-YKR-OF-PAUT-20-014', 'report_date': '25-Jan-2020', 'work_order': '28131360'},
    {'report_number': '04-YKR-OF-PAUT-20-078', 'report_date': '13-Apr-2020', 'work_order': '28151286'},
    {'report_number': '04-YKR-OF-PAUT-21-061', 'report_date': '03.May.2021', 'work_order': '28225713'},
    {'report_number': '04-YKR-OF-PAUT-21-187', 'report_date': '26.08.2021', 'work_order': '28171289(CLPW-16)'},
    {'report_number': '04-YKR-OF-PAUT-22-013', 'report_date': '17.02.2022', 'work_order': '28283123'},
    {'report_number': '04-YKR-OF-PAUT-22-033', 'report_date': '16-19.July.2022', 'work_order': '28314660'},
    {'report_number': '04-YKR-OF-UT-20-005', 'report_date': '28.Jan.2020', 'work_order': '28134968'},
    {'report_number': '04-YKR-OF-UT-20-059', 'report_date': '08.May.2020', 'work_order': '28098100'},
    {'report_number': '04-YKR-OF-UT-20-131', 'report_date': '12.Sep.2020', 'work_order': '28145681'},
    {'report_number': '04-YKR-OF-UT-21-111', 'report_date': '26.06.2021', 'work_order': '28235740,28209632(CLPW-09)'},
    {'report_number': '04-YKR-OF-UTT-21-355', 'report_date': '13.11.2021', 'work_order': '28216184'},
    {'report_number': '04-YKR-OF-UTT-22-017', 'report_date': '12.February.2022', 'work_order': '28283125'},
    {'report_number': '04-YKR-OF-UTT-22-065', 'report_date': '28.06.2022', 'work_order': '28301677'},
    {'report_number': '04-YKR-ON-PAUT-20-015', 'report_date': '14.Jan.2020', 'work_order': '28061606'},
    {'report_number': '04-YKR-ON-PAUT-20-016', 'report_date': '15,17.01.2020', 'work_order': '28118836'},
    {'report_number': '04-YKR-ON-PAUT-20-030', 'report_date': '11.Feb.2020', 'work_order': '28134184'},
    {'report_number': '04-YKR-ON-PAUT-20-076', 'report_date': '21.May.2020', 'work_order': '28080207'},
    {'report_number': '04-YKR-ON-PAUT-20-113', 'report_date': '03.August.2020', 'work_order': '28177320'},
    {'report_number': '04-YKR-ON-PAUT-20-160_Rev.1', 'report_date': '04-08.Dec.2020', 'work_order': '28189494'},
    {'report_number': '04-YKR-ON-PAUT-21-007', 'report_date': '13.January.2021', 'work_order': '28163914'},
    {'report_number': '04-YKR-ON-PAUT-21-308', 'report_date': '05th.NOVEMBER.2021', 'work_order': '27988541'},
    {'report_number': '04-YKR-ON-PAUT-21-309', 'report_date': '05th.NOVEMBER.2021', 'work_order': '27988541'},
    {'report_number': '04-YKR-ON-PAUT-21-336', 'report_date': '13.12.2021', 'work_order': '28271803'},
    {'report_number': '04-YKR-ON-PAUT-21-366', 'report_date': '28.Dec.21,01-04.Jan.2022', 'work_order': '28277198'},
    {'report_number': '04-YKR-ON-PAUT-22-007', 'report_date': '05.Jan.2022', 'work_order': '28276526'},
    {'report_number': '04-YKR-ON-PAUT-22-106', 'report_date': '10-13.march.2022', 'work_order': '28291331'},
    {'report_number': '04-YKR-ON-PAUT-22-141', 'report_date': '22.03.2022', 'work_order': '28262516'},
    {'report_number': '04-YKR-ON-PAUT-22-171', 'report_date': '01.04.2022', 'work_order': '28289509'},
    {'report_number': '04-YKR-ON-PAUT-22-740', 'report_date': '18.September.2022', 'work_order': '28321639'},
    {'report_number': '04-YKR-ON-UT-19-011', 'report_date': '15.Jan.2019', 'work_order': '28036714'},
    {'report_number': '04-YKR-ON-UT-19-081', 'report_date': '14.Feb.2019', 'work_order': '28061338'},
    {'report_number': '04-YKR-ON-UT-19-360', 'report_date': '01.July.2019', 'work_order': '28047503'},
    {'report_number': '04-YKR-ON-UT-19-388', 'report_date': '14.July.2019', 'work_order': '28046962'},
    {'report_number': '04-YKR-ON-UT-20-020', 'report_date': '21.Jan.2020', 'work_order': '28133727'},
    {'report_number': '04-YKR-ON-UT-20-024', 'report_date': '23.Jan.2020', 'work_order': '28139870'},
    {'report_number': '04-YKR-ON-UT-20-039', 'report_date': '26.Jan.2020', 'work_order': '28139870'},
    {'report_number': '04-YKR-ON-UT-20-143', 'report_date': '10.Mar.2020', 'work_order': '28147638'},
    {'report_number': '04-YKR-ON-UT-20-196', 'report_date': '26.Apr.2020', 'work_order': '28054444'},
    {'report_number': '04-YKR-ON-UT-20-397', 'report_date': '16.Nov.2020', 'work_order': '28198807'},
    {'report_number': '04-YKR-ON-UT-20-403', 'report_date': '20.Nov.2020', 'work_order': '28189493'},
    {'report_number': '04-YKR-ON-UT-20-432', 'report_date': '24.Dec.2020', 'work_order': '28146761'},
    {'report_number': '04-YKR-ON-UT-21-019', 'report_date': '07.January.2021', 'work_order': '28179078'},
    {'report_number': '04-YKR-ON-UT-21-317', 'report_date': '12.06.2021', 'work_order': '28193441'},
    {'report_number': '04-YKR-ON-UTT-21-419', 'report_date': '02.08.2021', 'work_order': '28144303'},
    {'report_number': '04-YKR-ON-UT-21-605', 'report_date': '15.10.2021', 'work_order': '28260303'},
    {'report_number': '04-YKR-ON-UT-21-761', 'report_date': '09.12.2021', 'work_order': '28270173'},
    {'report_number': '04-YKR-ON-UT-21-770', 'report_date': '02.12.2021', 'work_order': '28268723'},
    {'report_number': '04-YKR-ON-UTT-21-823', 'report_date': '17.12.2021', 'work_order': '28276529'},
    {'report_number': '04-YKR-ON-UTT-22-473', 'report_date': '20.05.2022', 'work_order': '28283756'},
    {'report_number': '04-YKR-ON-UT-22-009', 'report_date': '08.01.2022', 'work_order': '28261530'},
    {'report_number': '04-YKR-ON-UT-22-064', 'report_date': '30.01.2022', 'work_order': '28256457'},
    {'report_number': '04-YKR-ON-UTT-22-112', 'report_date': '01.03.2022', 'work_order': '28282656'},
    {'report_number': '04-YKR-ON-UTT22-265', 'report_date': '13.04.2022', 'work_order': '28283755'},
    {'report_number': '04-YKR-ON-UTT-22-305', 'report_date': '20.04.2022', 'work_order': '28301822'},
    {'report_number': '04-YKR-ON-UTT-22-336', 'report_date': '23.04.2022', 'work_order': '28301819'},
    {'report_number': '04-YKR-ON-UTT-22-341', 'report_date': '25.04.2022', 'work_order': '28291314'},
    {'report_number': '04-YKR-ON-UTT-22-377', 'report_date': '26.04.2022', 'work_order': '28301824'},
    {'report_number': '04-YKR-ON-UTT-22-618', 'report_date': '05.10.2022', 'work_order': '28283748'},
    {'report_number': '04-YKR-ON-UTT-22-674', 'report_date': '03.11.2022', 'work_order': '28304185'},
    {'report_number': '04-YKR-ON-UTT-22-714', 'report_date': '17.11.2022', 'work_order': '28289520'},
    {'report_number': '04-YKR-ON-UTT-22-756', 'report_date': '06.12.2022', 'work_order': '28283755'},
    {'report_number': '04-YKR-ON-UTT-22-811', 'report_date': '28.12.2022', 'work_order': '28343836'},
    {'report_number': '04-YKR-OS-UT-20-003', 'report_date': '02.Jan.2020', 'work_order': '28127480'},
    {'report_number': '04-YKR-OS-UT-20-394', 'report_date': '11.Nov.2020', 'work_order': '28187548'},
    {'report_number': '04-YKR-OS-UT-21-156', 'report_date': '18.Mar.2021', 'work_order': '28210044'},
    {'report_number': '04-YKR-OS-UT-21-794', 'report_date': '20.12.2021', 'work_order': '28271835'},
    {'report_number': '04-YKR-OS-UTT-21-499', 'report_date': '29.08.2021', 'work_order': '28223596'},
    {'report_number': '04-YKR-OS-UTT-21-742', 'report_date': '19.11.2021', 'work_order': '28271019'},
    {'report_number': '04-YKR-OS-UTT-22-496', 'report_date': '24.07.2022', 'work_order': '28296054'},
    {'report_number': '04-YKR-ON-UTT-22-506', 'report_date': '03.08.2022', 'work_order': 'NCOCRequest'},
    {'report_number': '04-YKR-PAUT-PRETAR-SRU-22-004', 'report_date': '06.04.2022', 'work_order': '28103893'},
    {'report_number': '04-YKR-PAUT-PRETAR-Gas-22-014', 'report_date': '02.05.2022', 'work_order': '28103903'},
    {'report_number': '04-YKR-PAUT-PRETAR-OFF-22-002', 'report_date': '02.04.2022', 'work_order': '28098582'},
    {'report_number': '04-YKR-PAUT-PRETAR-OFF-22-005', 'report_date': '17.04.2022', 'work_order': '28098335'},
    {'report_number': '04-YKR-ON-PRETAR-UTT-22-024', 'report_date': '20.03.2022', 'work_order': '28146514'},
    {'report_number': '04-YKR-UTT-PRETAR-GAS-22-164', 'report_date': '01-03.05.2022', 'work_order': '28103943'},
    {'report_number': '04-YKR-UTT-PRETAR-OFF-22-010', 'report_date': '14.03.2022', 'work_order': '28098534'},
    {'report_number': '04-YKR-UTT-PRETAR-OFF-22070', 'report_date': '01.May.2022', 'work_order': '28098546'})


# очистка номера репорта, даты репорта, номера Work Order от лишних (пробелы, новая строка) символов
class TestClearDataRepNumber(unittest.TestCase):
    def test_clear_data_rep_number(self):
        for i, path_report in enumerate(true_name_dir_files):
            self.assertEqual(YKR.utilities.clear_data_rep_number(YKR.utilities.number_report_wo_date(path_report)),
                             true_clear_number_report_wo_date[i])


true_reports_db = (('reports_db_ON_UTT_', False),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_OFF_PAUT_20.sqlite', True),
                   ('reports_db_OFF_PAUT_20.sqlite', True),
                   ('reports_db_OFF_PAUT_21.sqlite', True),
                   ('reports_db_OFF_PAUT_21.sqlite', True),
                   ('reports_db_OFF_PAUT_22.sqlite', True),
                   ('reports_db_OFF_PAUT_22.sqlite', True),
                   ('reports_db_OFF_UTT_20.sqlite', True),
                   ('reports_db_OFF_UTT_20.sqlite', True),
                   ('reports_db_OFF_UTT_20.sqlite', True),
                   ('reports_db_OFF_UTT_21.sqlite', True),
                   ('reports_db_OFF_UTT_21.sqlite', True),
                   ('reports_db_OFF_UTT_22.sqlite', True),
                   ('reports_db_OFF_UTT_22.sqlite', True),
                   ('reports_db_ON_PAUT_20.sqlite', True),
                   ('reports_db_ON_PAUT_20.sqlite', True),
                   ('reports_db_ON_PAUT_20.sqlite', True),
                   ('reports_db_ON_PAUT_20.sqlite', True),
                   ('reports_db_ON_PAUT_20.sqlite', True),
                   ('reports_db_ON_PAUT_20.sqlite', True),
                   ('reports_db_ON_PAUT_21.sqlite', True),
                   ('reports_db_ON_PAUT_21.sqlite', True),
                   ('reports_db_ON_PAUT_21.sqlite', True),
                   ('reports_db_ON_PAUT_21.sqlite', True),
                   ('reports_db_ON_PAUT_21.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_ON_UTT_19.sqlite', True),
                   ('reports_db_ON_UTT_19.sqlite', True),
                   ('reports_db_ON_UTT_19.sqlite', True),
                   ('reports_db_ON_UTT_19.sqlite', True),
                   ('reports_db_ON_UTT_20.sqlite', True),
                   ('reports_db_ON_UTT_20.sqlite', True),
                   ('reports_db_ON_UTT_20.sqlite', True),
                   ('reports_db_ON_UTT_20.sqlite', True),
                   ('reports_db_ON_UTT_20.sqlite', True),
                   ('reports_db_ON_UTT_20.sqlite', True),
                   ('reports_db_ON_UTT_20.sqlite', True),
                   ('reports_db_ON_UTT_20.sqlite', True),
                   ('reports_db_ON_UTT_21.sqlite', True),
                   ('reports_db_ON_UTT_21.sqlite', True),
                   ('reports_db_ON_UTT_21.sqlite', True),
                   ('reports_db_ON_UTT_21.sqlite', True),
                   ('reports_db_ON_UTT_21.sqlite', True),
                   ('reports_db_ON_UTT_21.sqlite', True),
                   ('reports_db_ON_UTT_21.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_', False),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_OS_UTT_20.sqlite', True),
                   ('reports_db_OS_UTT_20.sqlite', True),
                   ('reports_db_OS_UTT_21.sqlite', True),
                   ('reports_db_OS_UTT_21.sqlite', True),
                   ('reports_db_OS_UTT_21.sqlite', True),
                   ('reports_db_OS_UTT_21.sqlite', True),
                   ('reports_db_OS_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_ON_PAUT_22.sqlite', True),
                   ('reports_db_OFF_PAUT_22.sqlite', True),
                   ('reports_db_OFF_PAUT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_ON_UTT_22.sqlite', True),
                   ('reports_db_OFF_UTT_22.sqlite', True),
                   ('reports_db_OFF_UTT_', False))


# формирование имени БД, в которую будут записываться данные
class TestReportsDB(unittest.TestCase):
    def test_reports_db(self):
        for i, path_report in enumerate(true_clear_number_report_wo_date):
            break_break = True
            name_report = path_report['report_number']
            self.assertEqual(YKR.utilities.reports_db(name_report, break_break),
                             true_reports_db[i])


# получения номера словаря (таблицы) в которой есть ключевое слово "Nominal thickness"
# class TestFirstClearTableNominalThickness(unittest.TestCase):
#     def test_first_clear_table_nominal_thickness(self):
#         for i, path_report in enumerate(true_name_dir_files):
#             self.assertEqual(YKR.utilities.first_clear_table_nominal_thickness(YKR.utilities.number_report_wo_date(path_report)),
#                              true_first_clear_table_nominal_thickness[i])


var = unittest.main
